{"ast":null,"code":"var _jsxFileName = \"/home/lucas/projeto/zebify/frontend/src/pages/usersPage.js\",\n  _process$env$REACT_AP,\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useAuth } from \"../context/authContext\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API = (_process$env$REACT_AP = process.env.REACT_APP_API_URL) !== null && _process$env$REACT_AP !== void 0 ? _process$env$REACT_AP : \"http://localhost:3001\";\nconst UsersPage = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const token = localStorage.getItem(\"token\");\n  const [utilizadores, setUtilizadores] = useState([]);\n  const [loadingId, setLoadingId] = useState(null);\n  const carregarUtilizadores = useCallback(async () => {\n    try {\n      const res = await fetch(`${API}/api/users/with-status`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const data = await res.json();\n      setUtilizadores(data);\n    } catch (err) {\n      alert(\"Erro ao carregar utilizadores\");\n    }\n  }, [token]);\n  useEffect(() => {\n    if (user) carregarUtilizadores();\n  }, [user, carregarUtilizadores]);\n  const executarAcao = async (url, method = \"POST\", body = null) => {\n    try {\n      setLoadingId((body === null || body === void 0 ? void 0 : body.receiverId) || (body === null || body === void 0 ? void 0 : body.senderId) || null);\n      await fetch(url, {\n        method,\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: body ? JSON.stringify(body) : null\n      });\n      carregarUtilizadores();\n    } finally {\n      setLoadingId(null);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: \"20px\",\n      fontFamily: \"sans-serif\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Utilizadores\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), utilizadores.filter(u => u.id !== (user === null || user === void 0 ? void 0 : user.id)).map(u => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        marginBottom: \"10px\",\n        padding: \"10px\",\n        border: \"1px solid #ccc\",\n        borderRadius: \"6px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: u.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 15\n        }, this), \" - \", u.email, /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            backgroundColor: u.status === \"amigos\" ? \"green\" : u.status === \"pendente\" ? \"orange\" : u.status === \"recebido\" ? \"blue\" : \"#999\",\n            color: \"white\",\n            padding: \"2px 8px\",\n            marginLeft: \"10px\",\n            borderRadius: \"12px\",\n            fontSize: \"12px\",\n            textTransform: \"capitalize\"\n          },\n          children: u.status\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 13\n      }, this), u.status === \"amigos\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => executarAcao(`${API}/api/friends/${u.id}`, \"DELETE\"),\n        disabled: loadingId === u.id,\n        style: {\n          backgroundColor: \"red\",\n          color: \"white\"\n        },\n        children: \"Remover amigo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 15\n      }, this), u.status === \"pendente\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => executarAcao(`${API}/api/friends/request/${u.id}`, \"DELETE\"),\n        disabled: loadingId === u.id,\n        children: \"Cancelar pedido\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 15\n      }, this), u.status === \"recebido\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => executarAcao(`${API}/api/friends/accept`, \"POST\", {\n            senderId: u.id\n          }),\n          disabled: loadingId === u.id,\n          style: {\n            backgroundColor: \"green\",\n            color: \"white\",\n            marginRight: \"8px\"\n          },\n          children: \"Aceitar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => executarAcao(`${API}/api/friends/reject`, \"POST\", {\n            senderId: u.id\n          }),\n          disabled: loadingId === u.id,\n          style: {\n            backgroundColor: \"red\",\n            color: \"white\"\n          },\n          children: \"Recusar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true), u.status === \"nenhum\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => executarAcao(`${API}/api/friends/request`, \"POST\", {\n          receiverId: u.id\n        }),\n        disabled: loadingId === u.id,\n        children: \"Adicionar amigo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 15\n      }, this)]\n    }, u.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 11\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n};\n_s(UsersPage, \"vfJybtXHHqWJoVLnuXGlqaIIbec=\", false, function () {\n  return [useAuth];\n});\n_c = UsersPage;\nexport default UsersPage;\nvar _c;\n$RefreshReg$(_c, \"UsersPage\");","map":{"version":3,"names":["React","useEffect","useState","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","API","_process$env$REACT_AP","process","env","REACT_APP_API_URL","UsersPage","_s","user","token","localStorage","getItem","utilizadores","setUtilizadores","loadingId","setLoadingId","carregarUtilizadores","useCallback","res","fetch","headers","Authorization","data","json","err","alert","executarAcao","url","method","body","receiverId","senderId","JSON","stringify","style","padding","fontFamily","children","fileName","_jsxFileName","lineNumber","columnNumber","filter","u","id","map","className","marginBottom","border","borderRadius","name","email","backgroundColor","status","color","marginLeft","fontSize","textTransform","onClick","disabled","marginRight","_c","$RefreshReg$"],"sources":["/home/lucas/projeto/zebify/frontend/src/pages/usersPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useAuth } from \"../context/authContext\";\n\nconst API = process.env.REACT_APP_API_URL ?? \"http://localhost:3001\";\n\nconst UsersPage = () => {\n  const { user } = useAuth();\n  const token = localStorage.getItem(\"token\");\n\n  const [utilizadores, setUtilizadores] = useState([]);\n  const [loadingId, setLoadingId] = useState(null);\n\n  const carregarUtilizadores = useCallback(async () => {\n    try {\n      const res = await fetch(`${API}/api/users/with-status`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      setUtilizadores(data);\n    } catch (err) {\n      alert(\"Erro ao carregar utilizadores\");\n    }\n  }, [token]);\n\n  useEffect(() => {\n    if (user) carregarUtilizadores();\n  }, [user, carregarUtilizadores]);\n\n  const executarAcao = async (url, method = \"POST\", body = null) => {\n    try {\n      setLoadingId(body?.receiverId || body?.senderId || null);\n      await fetch(url, {\n        method,\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: body ? JSON.stringify(body) : null,\n      });\n      carregarUtilizadores();\n    } finally {\n      setLoadingId(null);\n    }\n  };\n\n  return (\n    <div style={{ padding: \"20px\", fontFamily: \"sans-serif\" }}>\n      <h1>Utilizadores</h1>\n\n      {utilizadores\n        .filter((u) => u.id !== user?.id)\n        .map((u) => (\n          <div\n            key={u.id}\n            className=\"card\"\n            style={{\n              marginBottom: \"10px\",\n              padding: \"10px\",\n              border: \"1px solid #ccc\",\n              borderRadius: \"6px\",\n            }}\n          >\n            <p>\n              <strong>{u.name}</strong> - {u.email}\n              <span\n                style={{\n                  backgroundColor:\n                    u.status === \"amigos\"\n                      ? \"green\"\n                      : u.status === \"pendente\"\n                      ? \"orange\"\n                      : u.status === \"recebido\"\n                      ? \"blue\"\n                      : \"#999\",\n                  color: \"white\",\n                  padding: \"2px 8px\",\n                  marginLeft: \"10px\",\n                  borderRadius: \"12px\",\n                  fontSize: \"12px\",\n                  textTransform: \"capitalize\",\n                }}\n              >\n                {u.status}\n              </span>\n            </p>\n\n            {u.status === \"amigos\" && (\n              <button\n                onClick={() =>\n                  executarAcao(`${API}/api/friends/${u.id}`, \"DELETE\")\n                }\n                disabled={loadingId === u.id}\n                style={{ backgroundColor: \"red\", color: \"white\" }}\n              >\n                Remover amigo\n              </button>\n            )}\n\n            {u.status === \"pendente\" && (\n              <button\n                onClick={() =>\n                  executarAcao(`${API}/api/friends/request/${u.id}`, \"DELETE\")\n                }\n                disabled={loadingId === u.id}\n              >\n                Cancelar pedido\n              </button>\n            )}\n\n            {u.status === \"recebido\" && (\n              <>\n                <button\n                  onClick={() =>\n                    executarAcao(`${API}/api/friends/accept`, \"POST\", {\n                      senderId: u.id,\n                    })\n                  }\n                  disabled={loadingId === u.id}\n                  style={{\n                    backgroundColor: \"green\",\n                    color: \"white\",\n                    marginRight: \"8px\",\n                  }}\n                >\n                  Aceitar\n                </button>\n                <button\n                  onClick={() =>\n                    executarAcao(`${API}/api/friends/reject`, \"POST\", {\n                      senderId: u.id,\n                    })\n                  }\n                  disabled={loadingId === u.id}\n                  style={{ backgroundColor: \"red\", color: \"white\" }}\n                >\n                  Recusar\n                </button>\n              </>\n            )}\n\n            {u.status === \"nenhum\" && (\n              <button\n                onClick={() =>\n                  executarAcao(`${API}/api/friends/request`, \"POST\", {\n                    receiverId: u.id,\n                  })\n                }\n                disabled={loadingId === u.id}\n              >\n                Adicionar amigo\n              </button>\n            )}\n          </div>\n        ))}\n    </div>\n  );\n};\n\nexport default UsersPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}